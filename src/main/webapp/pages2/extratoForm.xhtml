<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<head>
</head>
<body>
	<ui:composition>
		<!-- All html ignored before here -->
		<!-- 
		<f:loadBundle var="transactionMsgs" basename="br.com.bufunfa.finance.account.i18n.TransactionMessageSource"/>
		 -->
		<h:form prependId="false" id="extratoForm">
			<fieldset>
				<legend>Dados do Extrato</legend>
				<h:outputLabel value="Conta:" for="account"/>
				<p:selectOneMenu id="account"
					value="#{accountExtractController.account.id}">
					<f:selectItems value="#{accountController.leafItems}" />
				</p:selectOneMenu>
				<br/>
				
				<h:outputLabel value="Data inicial:" for="beginDate"/>
				<p:calendar id="beginDate" 
					value="#{accountExtractController.beginDate}"
					locale="pt_BR"
					pattern="dd/MM/yyyy"
					size="11">
				</p:calendar>
				<br/>
				
				<h:outputLabel value="Data final:" for="finalDate"/>
				<p:calendar id="finalDate"
					value="#{accountExtractController.endDate}" 
					locale="pt_BR"
					pattern="dd/MM/yyyy"
					size="11">
				</p:calendar>
				<br/>
				
				<p:commandButton value="Tirar extrato" action="#{accountExtractController.updateExtract}"
					update=":extractTableForm">
				</p:commandButton>
			</fieldset>
		</h:form>
		
		<h:form id="extractTableForm">
			<p:dataTable id="extratoTable" value="#{accountExtractController.accountExtract.transactionList}"
				rendered="#{accountExtractController.accountExtract != null}"
				emptyMessage="Nenhuma transacao encontrada" var="transaction">
				<p:column headerText="Data">
					<h:outputText value="#{transaction.originAccountEntry.date}">
						<f:convertDateTime locale="pt_BR"
								dateStyle="short" />
					</h:outputText>
				</p:column>
				<p:column headerText="Descricao">
					<h:outputText value="#{transaction.originAccountEntry.comment}"/>
				</p:column>
				<p:column headerText="Origem">
					<h:outputText value="#{transaction.originAccountEntry.account.name}"/>
				</p:column>
				<p:column headerText="Destino">
					<h:outputText value="#{transaction.destAccountEntry.account.name}"/>
				</p:column>
				<p:column headerText="Valor">
					<h:outputText value="#{transaction.originAccountEntry.value}">
						<f:convertNumber locale="pt_BR" type="currency" />
					</h:outputText>
				</p:column>
				<p:columnGroup type="footer">
					<p:row>
						<p:column colspan="4" footerText="Saldo:" style="text-align : right"/>
						<p:column footerText="#{accountExtractController.accountExtract.currentBalance}"/>
					</p:row>
				</p:columnGroup>
			</p:dataTable>
		</h:form>

		<!-- All html ignored after here -->

	</ui:composition>
</body>
</html>